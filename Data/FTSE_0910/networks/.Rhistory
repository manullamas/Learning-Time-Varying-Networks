write.csv(Dates, file = paste0(subpath,"Dates.csv"),row.names=FALSE)
path <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/Test1/'
subpath <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/'
myList = list.files(path, pattern="*.csv")
for (i in 1:length(myList)) {
assign(myList[i], read.csv(myList[i]))
}
df <-  Reduce(function(x,y) merge(x,y, by = 'Date'),
list(subset(AAPL.csv, select = c(Date, Close)),
subset(ADBE.csv, select = c(Date, Close)),
subset(AMZN.csv, select = c(Date, Close)),
subset(BRK.B.csv, select = c(Date, Close)),
subset(BSX.csv, select = c(Date, Close)),
subset(CSCO.csv, select = c(Date, Close)),
subset(GE.csv, select = c(Date, Close)),
subset(JNJ.csv, select = c(Date, Close)),
subset(JPM.csv, select = c(Date, Close)),
subset(MMM.csv, select = c(Date, Close)),
subset(MSFT.csv, select = c(Date, Close)),
subset(MTB.csv, select = c(Date, Close)),
subset(NKE.csv, select = c(Date, Close)),
subset(T.csv, select = c(Date, Close)),
subset(UNP.csv, select = c(Date, Close)),
subset(XOM.csv, select = c(Date, Close))))
path <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/Test1/'
subpath <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/'
myList = list.files(path, pattern="*.csv")
for (i in 1:length(myList)) {
assign(myList[i], read.csv(myList[i]))
}
for (i in 1:length(myList)) {
assign(myList[i], read.csv(paste0(path,myList[i])))
}
df <-  Reduce(function(x,y) merge(x,y, by = 'Date'),
list(subset(AAPL.csv, select = c(Date, Close)),
subset(ADBE.csv, select = c(Date, Close)),
subset(AMZN.csv, select = c(Date, Close)),
subset(BRK.B.csv, select = c(Date, Close)),
subset(BSX.csv, select = c(Date, Close)),
subset(CSCO.csv, select = c(Date, Close)),
subset(GE.csv, select = c(Date, Close)),
subset(JNJ.csv, select = c(Date, Close)),
subset(JPM.csv, select = c(Date, Close)),
subset(MMM.csv, select = c(Date, Close)),
subset(MSFT.csv, select = c(Date, Close)),
subset(MTB.csv, select = c(Date, Close)),
subset(NKE.csv, select = c(Date, Close)),
subset(T.csv, select = c(Date, Close)),
subset(UNP.csv, select = c(Date, Close)),
subset(XOM.csv, select = c(Date, Close))))
stockNames <- gsub(".csv", "", myList)    #Deleting extension from names
names(df) <- c('Date', stockNames)     #Naming variables in df
Stocks <- df[2:ncol(df)]
Dates <- df[1]
StocksNormalized <- data.frame(scale(Stocks))    #Normalization of stocks
write.csv(StocksNormalized, file = paste0(subpath,"StoksNormalized.csv"),row.names=FALSE)
write.csv(Dates, file = paste0(subpath,"Dates.csv"),row.names=FALSE)
names(Stocks)
write.csv(names(Stocks), file = paste0(subpath,"Stocks.csv"),row.names=FALSE)
?write.csv
write.csv(names(Stocks), file = paste0(subpath,"Stocks.csv"),row.names=FALSE, col.names=F)
write.csv(names(Stocks), file = paste0(subpath,"Stocks.csv"),row.names=FALSE, col.names=FALSE)
NAMES(sTOCKS)
names(Stocks)
write.csv(names(Stocks), file = paste0(subpath,"Stocks.csv"),row.names=FALSE)
write.csv(Stocks, file = paste0(subpath,"StocksNotNorm.csv"),row.names=FALSE)
?read.csv
path <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/US109senate/'
senate <- read.csv(paste0(path,'109senate.txt'))
View(senate)
senate <- read.csv(paste0(path,'109senate.txt', sep = ""))
senate <- read.csv(paste0(path,'109senate.txt', sep = " "))
senate <- read.table(paste0(path,'109senate.txt', sep = ""))
senate <- read.table(paste0(path,'109senate.txt', sep = ""))
senate <- read.table(paste0(path,'109senate.txt', sep = "", header = T))
senate <- read.table(paste0(path,'109senate.txt', sep = "", header = T))
senate <- read.table(paste0(path,'109senate.txt', sep = ""))
senate <- read.table(paste0(path,'109senate.txt'), sep = ""))
senate <- read.table(paste0(path,'109senate.txt'), sep = "")
senate <- read.table(paste0(path,'109senate.txt'), sep = "", header = T)
senate <- read.table(paste0(path,'109senate.txt'), sep = "t", header = T)
senate <- read.table(paste0(path,'109senate.txt'), sep = "t")
senate <- read.table(paste0(path,'109senate.txt'), sep = "\t")
senate <- read.table(paste0(path,'109senate.txt'), sep = "\t", header = T)
View(senate)
senate <- senate[-c(1,2)]
View(senate)
?gsub
prueba <- gsub(0, -1, senate)
class(prueba)
class(senate)
prueba <- data.frame(gsub(0, -1, senate))
View(prueba)
prueba <- gsub(0, -1, senate)
data.frame(prueba)
p <- data.frame(prueba)
rm(p)
prueba <- senate[senate=="0"] <- -1
senate[senate==0]
prueba <- senate[senate==0] <- -1
senate==0
senate[senate==0]
sum[senate==0]
sum(senate==0)
path <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/US109senate/'
senate <- read.table(paste0(path,'109senate.txt'), sep = "\t", header = T)
senate <- senate[-c(1,2)]   #Remove 1st (bills to vote) and 2nd (n missing votes) columns
path <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/US109senate/'
senate <- read.table(paste0(path,'109senate.txt'), sep = "\t", header = T)
senate <- read.table(paste0(path,'109senate.txt'), sep = "\t")
, header = T
senate <- senate[-c(1,2)]   #Remove 1st (bills to vote) and 2nd (n missing votes) columns
path <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/US109senate/'
senate <- read.table(paste0(path,'109senate.txt'), sep = "\t", header = T)
senate <- senate[-c(1,2)]   #Remove 1st (bills to vote) and 2nd (n missing votes) columns
View(senate)
sum(senate==0)
prueba <- senate[senate==0] <- -1
sum(senate==0)
sum(prueba==0)
senators <- names(senate)
senators
write.csv(senate, file = paste0(subpath,"109senate_clean.csv"))#,row.names=FALSE)
write.csv(senate, file = paste0(path,"109senate_clean.csv"))#,row.names=FALSE)
write.csv(senate, file = paste0(path,"109senate_clean.csv"),row.names=FALSE)
write.csv(senators, file = paste0(path,"senatorsTags.csv"),row.names=FALSE)
rm(list=ls())
save.image("C:/Users/Manuel/Desktop/Southampton/MasterThesis/Code/Rvariables.RData")
folderPath <- 'C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/FTSE_0910/'
StocksFull <- read.csv(paste0(folderPath,'FTSE_Stocks.csv'))
Stocks <- StocksFull[2:nrow(StocksFull),]  # remove AAL, not in sample
stockNames <- read.csv(paste0(folderPath,'networks/FTSE_indexes.csv'))
avgDegree <- read.csv(paste0(folderPath, 'networks/avgDegree.csv'), header = F)
degreeMatrix <- read.csv(paste0(folderPath, 'networks/degreeMatrix.csv'), header = F)
# LOAD ALL EPOCH'S MATRICES
filesList = list.files(paste0(folderPath,'networks/'), pattern="*.csv")
# matrix_list <- vector(mode="character", length=0)
# for (i in 1:length(filesList)) {
#   matrix_list[i] = unlist(strsplit(filesList[i], split='.', fixed=TRUE))[1]   #remove .csv
# }
# Open folder containing adjacency matrices
setwd('C:/Users/Manuel/Desktop/Southampton/MasterThesis/Data/FTSE_0910/networks')
# List of weighted matrices
listWeights = list.files(paste0(folderPath,'networks/'), pattern='*weights.csv')
weightedMatrices <- list()
for (i in seq_along(listWeights)) {
weightedMatrices[[i]] <- read.csv(file = listWeights[i], header = F)
}
# List of signed matrices
listSigned = list.files(paste0(folderPath,'networks/'), pattern='*signs.csv')
signedMatrices <- list()
for (i in seq_along(listSigned)) {
signedMatrices[[i]] <- read.csv(file = listSigned[i], header = F)
}
# TODO:
#     - plots (scatter) of avgDegree, degreeMatrix (y) for each of the stocks (names), with different colors for different sectors!!
#####################################################################################################
#################################
######   NETWORK DRAWING   ######
#################################
# Required libraries to plot networks
library(igraph)
library(network)
library(sna)
library(ndtv)
library(visNetwork)
# GIVE PROPER FORMAT TO THE INPUTS (-> igraph OBJECTS):  http://igraph.org/r/doc/graph_from_adjacency_matrix.html
adjacency_list_weights <- list()
for (i in 1:length(weightedMatrices)) {
adjacency_list_weights[[i]] <- graph_from_adjacency_matrix(as.matrix(weightedMatrices[[i]]), mode = "directed",
weighted = T, diag = TRUE, add.colnames = NULL, add.rownames = NA)
}
adjacency_list_signs <- list()
for (i in 1:length(weightedMatrices)) {
adjacency_list_signs[[i]] <- graph_from_adjacency_matrix(as.matrix(signedMatrices[[i]]), mode = "directed",
weighted = NULL, diag = TRUE, add.colnames = NULL, add.rownames = NA)
}
net <- simplify(adjacency_list_signs[[1]], remove.multiple = F, remove.loops = T)
net2 <- simplify(adjacency_list_weights[[1]], remove.multiple = F, remove.loops = T)
deg <- degreeMatrix[,1] #-----------------------------------> OUT DEGREE!!
V(net)$size <- 3*log(deg) # play with this parameter
E(net)$width <- E(net)$weight/6
E(net)$arrow.size <- .2
library(RColorBrewer)
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2)
?legend
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3)
?pdf
pdf(file = 'prueba.pdf', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3)
dev.off()
getwd()
pdf(file = 'prueba.pdf', width = 400, height = 350)
pdf(file = 'prueba1.pdf', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3)
dev.off()
png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3)
dev.off()
pdf(file = 'prueba1.pdf', width = 400, height = 350)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
pdf(file = 'prueba2.pdf', width = 400, height = 350)
print(plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black'))
print(legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3))
dev.off()
pdf(file = 'prueba1.pdf', width = 400, height = 350)
print(plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
)
dev.off()
pdf()
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 0.3)
dev.off()
pdf(width = 400, height = 350)
pdf(width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 1)
dev.off()
pdf(file = 'prueba1.pdf', width = 10, height = 10)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 1)
dev.off()
pdf(file = 'prueba2.pdf', width = 20, height = 20)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 1)
dev.off()
pdf(file = 'prueba3.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 0.2, x.intersp = 1)
dev.off()
pdf(file = 'prueba4.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=2, cex=.8, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
?legend
i
3
asd
# REMEMBER: issues with color when trimming the dataset (AAL wasnt in the sample), thats why in the legend Im using
pdf(file = 'prueba5.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
pdf(file = 'prueba6.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=1, y=1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
pdf(file = 'prueba7.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-1.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
pdf(file = 'prueba8.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-1, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
pdf(file = 'prueba9.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
View(degreeMatrix)
V(net)$size <- 3(deg)
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$size <- 3*deg
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
pdf(file = 'prueba10.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
V(net)$size <- 1.5*deg
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
pdf(file = 'prueba10.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
V(net)$size <- 0.5*deg
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
pdf(file = 'prueba10.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
deg
V(net)$size <- 2*log(deg)
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
pdf(file = 'prueba10.pdf', width = 15, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
V(net)$size <- 1.5*log(deg)
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
pdf(file = 'prueba11.pdf', width = 16, height = 15)
#png(file = 'pruebaPNG.png', width = 400, height = 350)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
V(net)$size <- 1.7*log(deg)
nSectors <- length(unique(Stocks$Sector.type))
col = list(color = brewer.pal(11, 'Paired'))   #Take 11 colors from sample called 'Paired'
V(net)$color <- col$color[Stocks$Sector.type]
pdf(file = 'prueba12.pdf', width = 16, height = 15)
plot(net, edge.arrow.size=.05, edge.curved=.1, vertex.label=as.character(stockNames[,2]), vertex.label.color = 'black')
#png(file = 'pruebaPNG.png', width = 400, height = 350)
legend(x=0.5, y=-0.5, unique(StocksFull$Sector), pch=21,  col="#777777", pt.bg=col$color,
pt.cex=3, cex=1.5, bty="n", ncol=1, y.intersp = 1, x.intersp = 1)
dev.off()
